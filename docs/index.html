<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì˜¤ëŠ˜ì˜ ë§ì”€ - ì„±ê²½ NFC í‚¤ë§</title>
    <link rel="stylesheet" href="style.css">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>âœï¸</text></svg>">
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>âœ ì˜¤ëŠ˜ì˜ ë§ì”€ âœ</h1>
            <div class="date" id="today"></div>
        </div>

        <div id="verse-container">
            <div style="text-align: center;">
                <span class="category-tag" id="category"></span>
            </div>

            <div class="verse-section">
                <div class="verse-reference" id="reference"></div>
                <div class="verse-content" id="content"></div>
                <div class="description" id="description"></div>
            </div>

            <div class="cross-decoration">âœ</div>

            <div class="button-group">
                <button onclick="loadRandomVerse()" class="btn">ë‹¤ë¥¸ ë§ì”€ ë³´ê¸°</button>
                <button onclick="shareVerse()" class="btn">ë§ì”€ ê³µìœ í•˜ê¸°</button>
            </div>

            <div class="category-grid">
                <button onclick="loadCategoryVerse('ìœ„ë¡œ')" class="category-card">ìœ„ë¡œ</button>
                <button onclick="loadCategoryVerse('ê°ì‚¬')" class="category-card">ê°ì‚¬</button>
                <button onclick="loadCategoryVerse('í‰ì•ˆ')" class="category-card">í‰ì•ˆ</button>
                <button onclick="loadCategoryVerse('ë¯¿ìŒ')" class="category-card">ë¯¿ìŒ</button>
                <button onclick="loadCategoryVerse('ì†Œë§')" class="category-card">ì†Œë§</button>
                <button onclick="loadCategoryVerse('ì‚¬ë‘')" class="category-card">ì‚¬ë‘</button>
                <button onclick="loadCategoryVerse('ì¶•ë³µ')" class="category-card">ì¶•ë³µ</button>
            </div>
        </div>

        <div class="footer">
            í•˜ë‚˜ë‹˜ì˜ ë§ì”€ì€ ì‚´ì•„ìˆê³  í™œë ¥ì´ ìˆì–´<br>
            ì¢Œìš°ì— ë‚ ì„  ì–´ë–¤ ê²€ë³´ë‹¤ë„ ì˜ˆë¦¬í•˜ë‹¤<br>
            - íˆë¸Œë¦¬ì„œ 4:12 -
        </div>
    </div>

    <script>
        let verses = [];
        let currentVerse = null;

        // ë‚ ì§œë¥¼ YYYYMMDD í˜•ì‹ì˜ ìˆ«ìë¡œ ë³€í™˜
        function getDateSeed() {
            const today = new Date();
            const year = today.getFullYear();
            const month = String(today.getMonth() + 1).padStart(2, '0');
            const day = String(today.getDate()).padStart(2, '0');
            return parseInt(year + month + day);
        }

        // ë‚ ì§œ ê¸°ë°˜ ì‹œë“œë¡œ ì¼ê´€ëœ ëœë¤ ì¸ë±ìŠ¤ ìƒì„±
        function getDailyIndex(seed, max) {
            // ê°„ë‹¨í•œ í•´ì‹œ í•¨ìˆ˜
            let hash = seed;
            hash = ((hash << 5) - hash) + seed;
            hash = hash & hash;
            return Math.abs(hash) % max;
        }

        // ì˜¤ëŠ˜ì˜ ë§ì”€ ë¡œë“œ
        function loadDailyVerse() {
            const seed = getDateSeed();
            const index = getDailyIndex(seed, verses.length);
            currentVerse = verses[index];
            displayVerse(currentVerse);
        }

        // ëœë¤ ë§ì”€ ë¡œë“œ
        function loadRandomVerse() {
            const randomIndex = Math.floor(Math.random() * verses.length);
            currentVerse = verses[randomIndex];
            displayVerse(currentVerse);
        }

        // ì¹´í…Œê³ ë¦¬ë³„ ë§ì”€ ë¡œë“œ
        function loadCategoryVerse(category) {
            const categoryVerses = verses.filter(v => v.category === category);
            if (categoryVerses.length > 0) {
                const randomIndex = Math.floor(Math.random() * categoryVerses.length);
                currentVerse = categoryVerses[randomIndex];
                displayVerse(currentVerse);
            }
        }

        // ë§ì”€ í‘œì‹œ
        function displayVerse(verse) {
            document.getElementById('category').textContent = verse.category;
            document.getElementById('reference').textContent = verse.reference;
            document.getElementById('content').textContent = verse.content;
            document.getElementById('description').textContent = `"${verse.description}"`;
        }

        // ì˜¤ëŠ˜ ë‚ ì§œ í‘œì‹œ
        function displayToday() {
            const today = new Date();
            const year = today.getFullYear();
            const month = String(today.getMonth() + 1).padStart(2, '0');
            const day = String(today.getDate()).padStart(2, '0');
            document.getElementById('today').textContent = `${year}ë…„ ${month}ì›” ${day}ì¼`;
        }

        // ë§ì”€ ê³µìœ 
        function shareVerse() {
            if (!currentVerse) return;

            const text = `${currentVerse.reference}\n\n${currentVerse.content}\n\nğŸ™ ì˜¤ëŠ˜ì˜ ë§ì”€`;

            if (navigator.share) {
                navigator.share({
                    title: 'ì˜¤ëŠ˜ì˜ ë§ì”€',
                    text: text
                }).catch((error) => console.log('ê³µìœ  ì·¨ì†Œë¨'));
            } else {
                // ë³µì‚¬ ê¸°ëŠ¥ í´ë°±
                navigator.clipboard.writeText(text).then(() => {
                    alert('ë§ì”€ì´ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!\nì¹´ì¹´ì˜¤í†¡ì´ë‚˜ ë¬¸ìë¡œ ê³µìœ í•´ë³´ì„¸ìš” ğŸ’•');
                }).catch(() => {
                    alert('ë³µì‚¬ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ë¸Œë¼ìš°ì € ì„¤ì •ì„ í™•ì¸í•´ì£¼ì„¸ìš”.');
                });
            }
        }

        // ì´ˆê¸°í™”
        async function init() {
            try {
                const response = await fetch('verses.json');
                verses = await response.json();
                displayToday();
                loadDailyVerse();
            } catch (error) {
                console.error('ë§ì”€ì„ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤:', error);
                document.getElementById('verse-container').innerHTML =
                    '<div class="error-message">ë§ì”€ì„ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</div>';
            }
        }

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì‹¤í–‰
        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>
